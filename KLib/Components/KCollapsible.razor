<div class="k-collapsible" @attributes="InputAttributes">

    <div class="k-collapsible-header" @onclick="Toggle">
        <div style="display: flex; flex-direction:row;">
            @Header
            @if (Collapsable)
            {
                <div style="margin-left:auto;">
                    @if (IsOpen)
                    {
                    <span class="material-icons">
                            expand_less
                        </span>
                    }
                    else
                    {
                    <span class="material-icons">
                            expand_more
                        </span>
                    }
                </div>
            }
        </div>

    </div>
    @if (Collapsable)
    {
        <div class="k-collapsible-content" style="display: @(IsOpen ? "block" : "none")">
            @ChildContent
        </div>
    }
</div>

@code {

    [Parameter(CaptureUnmatchedValues = true)]
    public Dictionary<string, object>? InputAttributes { get; set; }

    [Parameter] [EditorRequired] public RenderFragment ChildContent { get; set; } = null!;

    [Parameter] [EditorRequired] public RenderFragment Header { get; set; } = null!;

    [Parameter] public bool Collapsable { get; set; } = true;

    [Parameter] public bool IsOpen { get; set; }

    [Parameter] public EventCallback<bool> IsOpenChanged { get; set; }

    private async Task Toggle()
    {
        if (!Collapsable)
            return;
        IsOpen = !IsOpen;
        await IsOpenChanged.InvokeAsync(IsOpen);
    }

}